<!DOCTYPE html>
<html>
<head>
<title>Patient</title>
<script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>

<body>
	<h2>Patient</h2>
	<div id="patient">San Zhang</div>
	<table id="pt" style="display:none">
		<tr>
			<td>id</td>
			<td id="id"></td>
		</tr>

		<tr>
			<td>cname</td>
			<td id="cname"></td>
		</tr>

		<tr>
			<td>name</td>
			<td id="name"></td>
		</tr>

		<tr>
			<td>address</td>
			<td id="address"></td>
		</tr>

		<tr>
			<td>phone</td>
			<td id="phone"></td>
		</tr>

		<tr>
			<td>age</td>
			<td id="age"></td>
		</tr>

		<tr>
			<td>birthdate</td>
			<td id="birthdate"></td>
		</tr>
	</table>

	<table id="study_table" style="display:none" cellpadding="10">
		<tr>
			<td><h2>Study</h2></td>
		</tr>
		<tr>
			<td>id</td>
			<td>patient id</td>
			<td>comments</td>
			<td>physician</td>
			<td>modalities</td>

		</tr>
	</table>
	
	<table id="series_table" style="display:none" cellpadding="10">
		<tr>
			<td><h2>Series</h2></td>
		</tr>
		<tr>
			<td>id</td>
			<td>study id</td>			
			<td>institution</td>
			<td>comments</td>
			<td>modality</td>
			<td>time</td>
		</tr>
	</table>

	<script type="text/javascript">
		$('#patient').on('click', function() {
			$('#pt').show();
			$('#study_table').show();

			$.ajax({
				url : '/patient/info?id=1',
				success : function(ret) {
					$('#id').text(ret.id);
					$('#name').text(ret.name);
					$('#cname').text(ret.c_name);
					$('#address').text(ret.address);
					$('#phone').text(ret.phone);
					$('#age').text(ret.age);
					$('#birthdate').text(ret.birthdate);
					
					for(var i=0; i<ret.studies.length;i++){
						$('#study_table').append('<tr>			<td name="study_id">'+ret.studies[i].studyId+'</td>			<td name="patient_id">'+ret.studies[i].patientId+'</td>			<td name="comments">'+ret.studies[i].comments+'</td>			<td name="physician">'+ret.studies[i].physician+'</td>			<td name="modalities">'+ret.studies[i].modalities+'</td>		</tr>')
					}
					
					$('[name="study_id"]').parent().on('click', function(){
						$.ajax({
							url : '/study/info',
							success : function(ret) {
								$('#series_table').show();
								for(var i=0; i<ret.series.length;i++){
									$('#series_table').append('<tr>		<td name="series_id">'+ret.series[i].seriesId+'</td>		<td name="study_id">'+ret.series[i].studyId+'</td>			<td name="patient_id">'+ret.series[i].institution+'</td>			<td name="comments">'+ret.series[i].comments+'</td>			<td name="physician">'+ret.series[i].modality+'</td>			<td name="modalities">'+ret.series[i].time+'</td>		</tr>')
								}
							}
						});
					})
				}
			})
		})
	</script>
</body>
</html>
